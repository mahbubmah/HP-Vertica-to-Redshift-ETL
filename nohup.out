Completed 670 Bytes/670 Bytes (10.7 KiB/s) with 1 file(s) remainingdownload: s3://ash.data/vertica/scripts/config.json to ./config.json
Completed 143 Bytes/143 Bytes (895 Bytes/s) with 1 file(s) remainingdownload: s3://ash.data/vertica/scripts/LargeTables.json to ./LargeTables.json
2018-03-07 23:50:23,599 - root         - INFO    : Starting reading configuration....
2018-03-07 23:50:23,600 - root         - INFO    : Source Driver - com.vertica.jdbc.Driver
2018-03-07 23:50:23,600 - root         - INFO    : Source Host - 10.0.2.114
2018-03-07 23:50:23,600 - root         - INFO    : Source port - 5433
2018-03-07 23:50:23,600 - root         - INFO    : Source username - dbadmin
2018-03-07 23:50:23,600 - root         - INFO    : Source database - uav01d1
2018-03-07 23:50:23,600 - root         - INFO    : s3 bucket path - s3://ash.data/vertica/stage-folder
2018-03-07 23:50:23,600 - root         - INFO    : Degree of parallelism - 1
2018-03-07 23:50:23,600 - root         - INFO    : Reading configuration successfully.
s3://ash.data/vertica/scripts/config.json
{'username': u'dbadmin', 'tables': [{u'mappers': 10, u'split_column': u'MktSrcId', u'name': u'DimMktSource6', u'schema': u'SHSCRSWHGSummary'}], 'password': u'vfr45tgb', 'src_driver': u'com.vertica.jdbc.Driver', 'host': u'10.0.2.114', 'db_name': u'uav01d1', 'target_s3_path': u's3://ash.data/vertica/stage-folder', 'dop': 1, 'ssm_name': u'vertica-pw', 'port': 5433}
2018-03-07 23:50:23,606 - DimMktSource6 - INFO    : Starting process...
2018-03-07 23:50:23,606 - DimMktSource6 - INFO    : DimMktSource6 process using 10 mapper(s)
2018-03-07 23:50:23,606 - DimMktSource6 - INFO    : Processed file will save to - s3://ash.data/vertica/stage-folder/SHSCRSWHGSummary/DimMktSource6/dt=2018-03-07-23-50/
2018-03-07 23:50:23,607 - DimMktSource6 - INFO    : Source Database URL: jdbc:vertica://10.0.2.114/uav01d1
2018-03-07 23:50:23,617 - DimMktSource6 - INFO    : Query for select column: 

select lower(column_name) l_column_name, lower(data_type) data_type from v_catalog.columns t  where t.table_name='DimMktSource6' ;

2018-03-07 23:50:24,026 - DimMktSource6 - INFO    : Total number of row will process: 7372800
2018-03-07 23:50:24,026 - DimMktSource6 - DEBUG   :  Sqoop job query: 

select * from ( select mktsrcid, cast(to_hex(mktsrcguid) as varchar) mktsrcguid, cast(to_hex(htlguid) as varchar) htlguid, cast(to_hex(chnguid) as varchar) chnguid, mktsrccd, createdt, updatedt, langid, mktsrcnm, mktsrcdesc, htlid, chnid, tdwloaddatetime FROM SHSCRSWHGSummary.DimMktSource6 ) as t  where \$CONDITIONS

2018-03-07 23:50:24,026 - DimMktSource6 - INFO    : Sqoop job command 

sqoop import --driver com.vertica.jdbc.Driver --connect jdbc:vertica://10.0.2.114/uav01d1 --username dbadmin --password vfr45tgb --query "select * from ( select mktsrcid, cast(to_hex(mktsrcguid) as varchar) mktsrcguid, cast(to_hex(htlguid) as varchar) htlguid, cast(to_hex(chnguid) as varchar) chnguid, mktsrccd, createdt, updatedt, langid, mktsrcnm, mktsrcdesc, htlid, chnid, tdwloaddatetime FROM SHSCRSWHGSummary.DimMktSource6 ) as t  where \$CONDITIONS" --target-dir s3://ash.data/vertica/stage-folder/SHSCRSWHGSummary/DimMktSource6/dt=2018-03-07-23-50/ --direct --as-avrodatafile -m 10 --split-by MktSrcId -- --schema SHSCRSWHGSummary


2018-03-07 23:50:24,026 - DimMktSource6 - INFO    : Sqoop job starting...
Warning: /usr/lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hive/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
18/03/07 23:50:25 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6
18/03/07 23:50:25 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/07 23:50:25 WARN sqoop.ConnFactory: Parameter --driver is set to an explicit driver however appropriate connection manager is not being set (via --connection-manager). Sqoop is going to fall back to org.apache.sqoop.manager.GenericJdbcManager. Please specify explicitly which connection manager should be used next time.
18/03/07 23:50:26 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/07 23:50:26 INFO tool.CodeGenTool: Beginning code generation
18/03/07 23:50:26 INFO manager.SqlManager: Executing SQL statement: select * from ( select mktsrcid, cast(to_hex(mktsrcguid) as varchar) mktsrcguid, cast(to_hex(htlguid) as varchar) htlguid, cast(to_hex(chnguid) as varchar) chnguid, mktsrccd, createdt, updatedt, langid, mktsrcnm, mktsrcdesc, htlid, chnid, tdwloaddatetime FROM SHSCRSWHGSummary.DimMktSource6 ) as t  where  (1 = 0) 
18/03/07 23:50:26 INFO manager.SqlManager: Executing SQL statement: select * from ( select mktsrcid, cast(to_hex(mktsrcguid) as varchar) mktsrcguid, cast(to_hex(htlguid) as varchar) htlguid, cast(to_hex(chnguid) as varchar) chnguid, mktsrccd, createdt, updatedt, langid, mktsrcnm, mktsrcdesc, htlid, chnid, tdwloaddatetime FROM SHSCRSWHGSummary.DimMktSource6 ) as t  where  (1 = 0) 
18/03/07 23:50:26 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /usr/lib/hadoop-mapreduce
Note: /tmp/sqoop-hadoop/compile/f5f9fab3a11f17573d3ee89a2235224f/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/07 23:50:30 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-hadoop/compile/f5f9fab3a11f17573d3ee89a2235224f/QueryResult.jar
18/03/07 23:50:30 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/07 23:50:30 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/07 23:50:34 INFO manager.SqlManager: Executing SQL statement: select * from ( select mktsrcid, cast(to_hex(mktsrcguid) as varchar) mktsrcguid, cast(to_hex(htlguid) as varchar) htlguid, cast(to_hex(chnguid) as varchar) chnguid, mktsrccd, createdt, updatedt, langid, mktsrcnm, mktsrcdesc, htlid, chnid, tdwloaddatetime FROM SHSCRSWHGSummary.DimMktSource6 ) as t  where  (1 = 0) 
18/03/07 23:50:34 INFO manager.SqlManager: Executing SQL statement: select * from ( select mktsrcid, cast(to_hex(mktsrcguid) as varchar) mktsrcguid, cast(to_hex(htlguid) as varchar) htlguid, cast(to_hex(chnguid) as varchar) chnguid, mktsrccd, createdt, updatedt, langid, mktsrcnm, mktsrcdesc, htlid, chnid, tdwloaddatetime FROM SHSCRSWHGSummary.DimMktSource6 ) as t  where  (1 = 0) 
18/03/07 23:50:34 INFO mapreduce.DataDrivenImportJob: Writing Avro schema file: /tmp/sqoop-hadoop/compile/f5f9fab3a11f17573d3ee89a2235224f/QueryResult.avsc
18/03/07 23:50:34 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/07 23:50:35 INFO impl.TimelineClientImpl: Timeline service address: http://ip-10-0-2-224.fizer.com:8188/ws/v1/timeline/
18/03/07 23:50:35 INFO client.RMProxy: Connecting to ResourceManager at ip-10-0-2-224.fizer.com/10.0.2.224:8032
18/03/07 23:50:37 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/07 23:50:37 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(MktSrcId), MAX(MktSrcId) FROM (select * from ( select mktsrcid, cast(to_hex(mktsrcguid) as varchar) mktsrcguid, cast(to_hex(htlguid) as varchar) htlguid, cast(to_hex(chnguid) as varchar) chnguid, mktsrccd, createdt, updatedt, langid, mktsrcnm, mktsrcdesc, htlid, chnid, tdwloaddatetime FROM SHSCRSWHGSummary.DimMktSource6 ) as t  where  (1 = 1) ) AS t1
18/03/07 23:50:37 INFO mapreduce.JobSubmitter: number of splits:10
18/03/07 23:50:38 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1518583347356_0075
18/03/07 23:50:38 INFO impl.YarnClientImpl: Submitted application application_1518583347356_0075
18/03/07 23:50:38 INFO mapreduce.Job: The url to track the job: http://ip-10-0-2-224.fizer.com:20888/proxy/application_1518583347356_0075/
18/03/07 23:50:38 INFO mapreduce.Job: Running job: job_1518583347356_0075
18/03/07 23:50:48 INFO mapreduce.Job: Job job_1518583347356_0075 running in uber mode : false
18/03/07 23:50:48 INFO mapreduce.Job:  map 0% reduce 0%
18/03/07 23:51:35 INFO mapreduce.Job:  map 10% reduce 0%
18/03/07 23:51:36 INFO mapreduce.Job:  map 20% reduce 0%
18/03/07 23:52:10 INFO mapreduce.Job:  map 40% reduce 0%
18/03/07 23:52:14 INFO mapreduce.Job:  map 60% reduce 0%
18/03/07 23:52:19 INFO mapreduce.Job:  map 70% reduce 0%
18/03/07 23:52:20 INFO mapreduce.Job:  map 80% reduce 0%
18/03/07 23:52:57 INFO mapreduce.Job:  map 100% reduce 0%
18/03/07 23:53:01 INFO mapreduce.Job: Job job_1518583347356_0075 completed successfully
18/03/07 23:53:01 INFO mapreduce.Job: Counters: 36
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=1489110
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1102
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=10
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
		S3: Number of bytes read=0
		S3: Number of bytes written=1277173560
		S3: Number of read operations=0
		S3: Number of large read operations=0
		S3: Number of write operations=0
	Job Counters 
		Killed map tasks=3
		Launched map tasks=13
		Other local map tasks=13
		Total time spent by all maps in occupied slots (ms)=30733296
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=640277
		Total vcore-milliseconds taken by all map tasks=640277
		Total megabyte-milliseconds taken by all map tasks=983465472
	Map-Reduce Framework
		Map input records=7372800
		Map output records=7372800
		Input split bytes=1102
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=7724
		CPU time spent (ms)=318280
		Physical memory (bytes) snapshot=6043090944
		Virtual memory (bytes) snapshot=33025499136
		Total committed heap usage (bytes)=5185732608
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=1277173560
18/03/07 23:53:01 INFO mapreduce.ImportJobBase: Transferred 0 bytes in 146.8953 seconds (0 bytes/sec)
18/03/07 23:53:01 INFO mapreduce.ImportJobBase: Retrieved 7372800 records.
2018-03-07 23:53:01,886 - DimMktSource6 - INFO    : Sqoop job finished.
2018-03-07 23:53:01,886 - DimMktSource6 - INFO    : Process successfully completed.
2018-03-07 23:53:01,886 - DimMktSource6 - INFO    : Total time taken - 158.28 sec.
./env/lib64/python2.7/site-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use "pip install psycopg2-binary" instead. For details see: <http://initd.org/psycopg/docs/install.html#binary-install-from-pypi>.
  """)
Completed 670 Bytes/670 Bytes (7.0 KiB/s) with 1 file(s) remainingdownload: s3://ash.data/vertica/scripts/config.json to ./config.json
Completed 143 Bytes/143 Bytes (2.2 KiB/s) with 1 file(s) remainingdownload: s3://ash.data/vertica/scripts/LargeTables.json to ./LargeTables.json
2018-03-07 23:56:15,846 - root         - INFO    : Target host - rsdata.c5y5lcyfmqhg.us-east-1.redshift.amazonaws.com
2018-03-07 23:56:15,846 - root         - INFO    : Target port - 5439
2018-03-07 23:56:15,846 - root         - INFO    : Target username - admin
2018-03-07 23:56:15,846 - root         - INFO    : Target Database - qsdata
2018-03-07 23:56:15,846 - root         - INFO    : s3 bucket path - s3://ash.data/vertica/stage-folder
2018-03-07 23:56:15,846 - root         - INFO    : Degree of parallelism - 2
2018-03-07 23:56:15,846 - root         - INFO    : Reading configuration successfully.
2018-03-07 23:56:15,854 - DimMktSource6 - INFO    : Starting process...
2018-03-07 23:56:15,854 - DimMktSource6 - INFO    : DimMktSource6 process
2018-03-07 23:56:15,854 - DimMktSource6 - INFO    : Processed file will save to - s3://ash.data/vertica/stage-folder/SHSCRSWHGSummary/DimMktSource6/dt=2018-03-07-23-50/
2018-03-07 23:56:15,895 - DimMktSource6 - INFO    : Total number of row before copy: 0
2018-03-07 23:56:15,895 - DimMktSource6 - INFO    : There is no data in target table. Full copy process will run.
2018-03-07 23:56:15,895 - DimMktSource6 - INFO    : Executing redshift copy command...
2018-03-07 23:56:15,895 - DimMktSource6 - INFO    : 

 TRUNCATE SHSCRSWHGSummary.DimMktSource6; COMMIT;  copy SHSCRSWHGSummary.DimMktSource6 from 's3://ash.data/vertica/stage-folder/SHSCRSWHGSummary/DimMktSource6/dt=2018-03-07-23-50/'  iam_role 'arn:aws:iam::324827999179:role/myRedshiftRole' format as avro 'auto' ACCEPTANYDATE DATEFORMAT 'YYYY-MM-DD' TIMEFORMAT 'epochmillisecs';  commit;


2018-03-07 23:56:47,285 - DimMktSource6 - INFO    : Total number of row after copy: 7372800
2018-03-07 23:56:47,285 - DimMktSource6 - INFO    : Total number of row copied: 7372800
2018-03-07 23:56:47,285 - DimMktSource6 - INFO    : Redshift copy process finished
2018-03-07 23:56:47,285 - DimMktSource6 - INFO    : Process successfully completed.
2018-03-07 23:56:47,285 - DimMktSource6 - INFO    : Total time taken - 31.43 sec.
